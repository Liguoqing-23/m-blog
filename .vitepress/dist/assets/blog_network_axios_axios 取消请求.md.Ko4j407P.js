import{_ as s,D as i,C as a,am as n}from"./chunks/framework.BDOtvRbC.js";const g=JSON.parse('{"title":"axios 取消请求","description":"","frontmatter":{},"headers":[],"relativePath":"blog/network/axios/axios 取消请求.md","filePath":"blog/network/axios/axios 取消请求.md"}'),t={name:"blog/network/axios/axios 取消请求.md"},l=n(`<h1 id="axios-取消请求" tabindex="-1">axios 取消请求 <a class="header-anchor" href="#axios-取消请求" aria-label="Permalink to &quot;axios 取消请求&quot;">​</a></h1><h2 id="通过-canceltoken-取消请求" tabindex="-1">通过 cancelToken 取消请求 <a class="header-anchor" href="#通过-canceltoken-取消请求" aria-label="Permalink to &quot;通过 cancelToken 取消请求&quot;">​</a></h2><p>创建一个 cancel token，然后将 cancel token 传递给请求的配置中，当我们需要取消请求时，调用 cancel 函数即可。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes monokai monokai vp-code"><code><span class="line"><span style="--shiki-light:#66D9EF;--shiki-dark:#66D9EF;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;"> source </span><span style="--shiki-light:#F92672;--shiki-dark:#F92672;">=</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;"> axios.CancelToken.</span><span style="--shiki-light:#A6E22E;--shiki-dark:#A6E22E;">source</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A6E22E;--shiki-dark:#A6E22E;">axios</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">({</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">    method: </span><span style="--shiki-light:#E6DB74;--shiki-dark:#E6DB74;">&quot;get&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">,</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">    url: </span><span style="--shiki-light:#E6DB74;--shiki-dark:#E6DB74;">&quot;/user/12345&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">,</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">    cancelToken: source.token,</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#88846F;--shiki-dark:#88846F;">// 取消请求</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">source.</span><span style="--shiki-light:#A6E22E;--shiki-dark:#A6E22E;">cancel</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#E6DB74;--shiki-dark:#E6DB74;">&quot;Operation canceled by the user.&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">);</span></span></code></pre></div><h2 id="取消重复请求-防抖" tabindex="-1">取消重复请求 防抖 <a class="header-anchor" href="#取消重复请求-防抖" aria-label="Permalink to &quot;取消重复请求 防抖&quot;">​</a></h2><p>有时候我们需要取消请求，比如在用户输入框中输入内容时，我们需要发送请求，但是用户输入的速度可能比请求的速度快，这时候我们就需要取消上一次的请求，只保留最后一次请求。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes monokai monokai vp-code"><code><span class="line"><span style="--shiki-light:#66D9EF;--shiki-dark:#66D9EF;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;"> source </span><span style="--shiki-light:#F92672;--shiki-dark:#F92672;">=</span><span style="--shiki-light:#AE81FF;--shiki-dark:#AE81FF;"> null</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#66D9EF;--shiki-dark:#66D9EF;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">const</span><span style="--shiki-light:#A6E22E;--shiki-dark:#A6E22E;"> fetchData</span><span style="--shiki-light:#F92672;--shiki-dark:#F92672;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;"> () </span><span style="--shiki-light:#66D9EF;--shiki-dark:#66D9EF;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;"> {</span></span>
<span class="line"><span style="--shiki-light:#F92672;--shiki-dark:#F92672;">    if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;"> (source) {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">        source.</span><span style="--shiki-light:#A6E22E;--shiki-dark:#A6E22E;">cancel</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#E6DB74;--shiki-dark:#E6DB74;">&quot;Operation canceled by the user.&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">    source </span><span style="--shiki-light:#F92672;--shiki-dark:#F92672;">=</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;"> axios.CancelToken.</span><span style="--shiki-light:#A6E22E;--shiki-dark:#A6E22E;">source</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A6E22E;--shiki-dark:#A6E22E;">    axios</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">({</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">        method: </span><span style="--shiki-light:#E6DB74;--shiki-dark:#E6DB74;">&quot;get&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">,</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">        url: </span><span style="--shiki-light:#E6DB74;--shiki-dark:#E6DB74;">&quot;/user/12345&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">,</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">        cancelToken: source.token,</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">    });</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#F8F8F2;">};</span></span></code></pre></div>`,7),F=[l];function e(h,k,p,o,r,c){return a(),i("div",null,F)}const y=s(t,[["render",e]]);export{g as __pageData,y as default};
